      SUBROUTINE NBL(BTN,RN,YON,QNO3,SSFNO3,VNO3,QNO2,SSFNO2,VNO2,QN2O,&
      SSFN2O,VN2O,DN,TFO,YLN,VOL,FNO3,FNH3,FX,BURN,DFN2OT,FTN,KBL,KW,MSO)
!     EPIC1102
!     THIS SUBPROGRAM COMPUTES THE N & P BALANCES AT THE END OF THE
!     SIMULATION
      DIMENSION KW(MSO+3)
      DF=BTN+RN-YON-QNO3-SSFNO3-VNO3-QNO2-SSFNO2-VNO2-QN2O-SSFN2O-VN2O&
      -DN-YLN-VOL+FNO3+FNH3-FTN+FX-BURN+TFO+DFN2OT
      PER=100.*DF/FTN
      SELECT CASE(KBL)
          CASE(1)
!              WRITE(KW(1),'(/T10,A)')'N BALANCE'
!              WRITE(KW(1),1)PER,DF,BTN,RN,YON,QNO3,SSFNO3,VNO3,QNO2,&
!              SSFNO2,VNO2,QN2O,SSFN2O,VN2O,DN,YLN,VOL,FNO3,FNH3,FX,TFO,&
!              BURN,DFN2OT,FTN
          CASE(2)
!              WRITE(KW(1),'(/T10,A)')'P BALANCE'
!              WRITE(KW(1),8)PER,DF,BTN,YON,QNO3,VNO3,YLN,FNO3,TFO,FTN
          CASE(3)
!              WRITE(KW(1),'(/T10,A)')'K BALANCE'
!              WRITE(KW(1),9)PER,DF,BTN,YON,QNO3,SSFNO3,VNO3,YLN,FNO3,FTN
      END SELECT
      RETURN
    1 FORMAT(5X,'PER =',E13.6,2X,'DF  =',E13.6,2X,'BTOT=',E13.6,2X,&
      'PCP =',E13.6,2X,'Y   =',E13.6,2X,'QNO3=',E13.6/5X,'SNO3=',E13.6,&
      2X,'VNO3=',E13.6,2X,'QNO2=',E13.6,2X,'SNO2=',E13.6,2X,'VNO2=',&
      E13.6,2X,'QN2O=',E13.6/5X,'SN2O=',E13.6,2X,'VN2O=',E13.6,2X,&
      'DNIT=',E13.6,2X,'YLD =',E13.6,2X,'VOL =',E13.6,2X,'FNO3=',E13.6/&
      5X,'FNH3=',E13.6,2X,'FIX =',E13.6,2X,'FORG=',E13.6,2X,'BURN=',&
      E13.6,2X,'FN2O=',E13.6,2X,'FTOT=',E13.6)
    8 FORMAT(5X,'PER =',E13.6,2X,'DF  =',E13.6,2X,'BTOT=',E13.6,2X,&
      'Y   =',E13.6,2X,'Q   =',E13.6,2X,'PRK =',E13.6/5X,'YLD =',E13.6,&
      2X,'FPML=',E13.6,2X,'FPO =',E13.6,2X,'ETOT=',E13.6)
    9 FORMAT(5X,'PER =',E13.6,2X,'DF  =',E13.6,2X,'BTOT=',E13.6,2X,&
      'Y   =',E13.6,2X,'Q   =',E13.6,2X,'SSF =',E13.6/5X,'PRK =',E13.6,&
      2X,'YLD =',E13.6,2X,'FKM =',E13.6,2X,'ETOT=',E13.6)
      END